[comment]: # (Do not edit this file as it is autogenerated. Go to docs/individual-docs if you want to make edits.)

# Rust

The `languages.rust` module provides comprehensive support for [Rust](https://www.rust-lang.org/) development, offering flexible toolchain management through two distinct approaches.

## Getting started

Enable Rust support in your `devenv.nix`:

```nix
{
  languages.rust.enable = true;
}
```

This will provide a complete Rust development environment with `rustc`, `cargo`, `clippy`, `rustfmt`, and `rust-analyzer`.

## Toolchain management

devenv supports two approaches for managing Rust toolchains:

### 1. nixpkgs channel (default)

The `nixpkgs` channel is easy to set up and uses the Rust version currently available in your nixpkgs revision. However, it's limited to the version in nixpkgs.

```nix
{
  languages.rust = {
    enable = true;
    channel = "nixpkgs"; # default
  };
}
```

### 2. rust-overlay channels

For more control over versions and features, use the `stable`, `beta`, or `nightly` channels powered by [rust-overlay](https://github.com/oxalica/rust-overlay):

- ✅ Rustup-like channel selection
- ✅ Access to any Rust version
- ✅ Support for cross-compilation targets

```nix
{
  languages.rust = {
    enable = true;
    channel = "stable";
    version = "1.81.0"; # or "latest"
  };
}
```

## Examples

### Basic setup with latest stable

```nix
{
  languages.rust = {
    enable = true;
    channel = "stable";
  };
}
```

### Nightly Rust with extra components

```nix
{
  languages.rust = {
    enable = true;
    channel = "nightly";
    components = [ "rustc" "cargo" "clippy" "rustfmt" "rust-analyzer" "miri" ];
  };
}
```

### Cross-compilation setup

```nix
{
  languages.rust = {
    enable = true;
    channel = "stable";
    targets = [ "wasm32-unknown-unknown" "aarch64-unknown-linux-gnu" ];
  };
}
```

### Minimal installation

```nix
{
  languages.rust = {
    enable = true;
    channel = "stable";
    components = [ "rustc" "cargo" "rust-std" ];
  };
}
```

<!-- TODO: expose the instantiated rust-bin library -->
<!-- ### Using rust-toolchain.toml -->
<!---->
<!-- If your project uses a `rust-toolchain.toml` file, you can use it to create a custom toolchain with `rust-overlay`: -->
<!---->
<!-- ```nix -->
<!-- { config, ... }: -->
<!-- { -->
<!--   languages.rust = { -->
<!--     enable = true; -->
<!--     channel = "stable"; -->
<!--     toolchain = config.languages.rust.rustBin.fromRustupToolchainFile ./rust-toolchain.toml; -->
<!--   }; -->
<!-- } -->
<!-- ``` -->
<!---->
<!-- Example `rust-toolchain.toml`: -->
<!-- ```toml -->
<!-- [toolchain] -->
<!-- channel = "1.81.0" -->
<!-- components = ["rustfmt", "rust-analyzer"] -->
<!-- targets = ["wasm32-unknown-unknown"] -->
<!-- profile = "default" -->
<!-- ``` -->

## Packaging applications using Nix

devenv can automatically package Rust projects using [crate2nix](https://github.com/nix-community/crate2nix).

### Setup

First, add the crate2nix input:

```bash
devenv inputs add crate2nix github:nix-community/crate2nix --follows nixpkgs
```

### Basic usage

```nix
{ config, ... }:
let
  myapp = config.languages.rust.import ./path/to/cargo/project {};
in
{
  languages.rust.enable = true;
  packages = [ myapp ];
  
  # Expose as outputs for building
  outputs = {
    inherit myapp;
  };
}
```

Then build the package:

```bash
devenv build outputs.myapp
```

The imported package will be available in your environment and can be built as an [output](/reference/options/#outputs).

## Integration with other tools

### Git hooks

Rust tools integrate seamlessly with [git hooks](/reference/options/#git-hookshooks):

```nix
{
  languages.rust.enable = true;

  git-hooks.hooks = {
    rustfmt.enable = true;
    clippy.enable = true;
  };
}
```

[comment]: # (Please add your documentation on top of this line)

## Options

### languages\.rust\.enable



Whether to enable tools for Rust development\.



*Type:*
boolean



*Default:*
` false `



*Example:*
` true `



### languages\.rust\.channel

The rustup toolchain to install\.



*Type:*
one of “nixpkgs”, “stable”, “beta”, “nightly”



*Default:*
` "nixpkgs" `



### languages\.rust\.components



List of [Rustup components](https://rust-lang\.github\.io/rustup/concepts/components\.html)
to install\. Defaults to those available in ` nixpkgs `\.



*Type:*
list of string



*Default:*
` [ "rustc" "cargo" "clippy" "rustfmt" "rust-analyzer" ] `



### languages\.rust\.mold\.enable



Use [mold](https://github\.com/rui314/mold) as the linker\.

mold is a faster drop-in replacement for existing Unix linkers\.
It is several times quicker than the LLVM lld linker\.



*Type:*
boolean



*Default:*
` false `



### languages\.rust\.rustflags



Extra flags to pass to the Rust compiler\.



*Type:*
string



*Default:*
` "" `



### languages\.rust\.targets



List of extra [targets](https://doc\.rust-lang\.org/nightly/rustc/platform-support\.html)
to install\. Defaults to only the native target\.



*Type:*
list of string



*Default:*
` [ ] `



### languages\.rust\.toolchain



Rust component packages\. May optionally define additional components, for example ` miri `\.



*Type:*
attribute set of package



*Default:*
` nixpkgs `



### languages\.rust\.toolchain\.cargo



cargo package



*Type:*
null or package



*Default:*
` pkgs.cargo `



### languages\.rust\.toolchain\.clippy



clippy package



*Type:*
null or package



*Default:*
` pkgs.clippy `



### languages\.rust\.toolchain\.rust-analyzer



rust-analyzer package



*Type:*
null or package



*Default:*
` pkgs.rust-analyzer `



### languages\.rust\.toolchain\.rustc



rustc package



*Type:*
null or package



*Default:*
` pkgs.rustc `



### languages\.rust\.toolchain\.rustfmt



rustfmt package



*Type:*
null or package



*Default:*
` pkgs.rustfmt `



### languages\.rust\.toolchainPackage



The aggregated toolchain package, which includes the configured components and targets\.
This is automatically set based on the channel and components configuration\.



*Type:*
package



### languages\.rust\.version



Which version of rust to use, this value could be ` latest `,` 1.81.0 `, ` 2021-01-01 `\.
Only works when languages\.rust\.channel is NOT nixpkgs\.



*Type:*
string



*Default:*
` "latest" `
